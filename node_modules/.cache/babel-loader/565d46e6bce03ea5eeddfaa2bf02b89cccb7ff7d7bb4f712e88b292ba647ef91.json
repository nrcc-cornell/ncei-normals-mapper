{"ast":null,"code":"var _jsxFileName = \"/Users/keith/progs/React/ncei-normals-mapper/src/components/MapLegend.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useRef, useState } from \"react\";\nimport Table from '@mui/material/Table';\nimport TableBody from '@mui/material/TableBody';\nimport TableCell from '@mui/material/TableCell';\nimport TableContainer from '@mui/material/TableContainer';\nimport TableRow from '@mui/material/TableRow';\nimport { makeStyles } from '@mui/styles';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst useStyles = makeStyles(theme => ({\n  keyContainer: {\n    marginTop: \"1em\"\n  }\n}));\nconst MapLegend = props => {\n  _s();\n  const {\n    imgInfo,\n    propLevels,\n    updateLevels,\n    updateColors\n  } = props;\n  const {\n    levels,\n    cmap,\n    range\n  } = imgInfo;\n  const [width, setWidth] = useState();\n  const [eachWidth, setEachWidth] = useState();\n  const ref = useRef(null);\n  const classes = useStyles();\n  const color_styles = cmap.map(color => {\n    return {\n      height: \"28px\",\n      backgroundColor: color,\n      opacity: \"0.8\"\n    };\n  });\n  useEffect(() => {\n    // trim off insignificant digits e.g. 1.10000000001 => 1.1\n    const levelLabels = levels.map(lev => {\n      return Math.abs(Math.round(lev * 100) / 100 - lev) > 0 ? parseFloat(lev.toFixed(2)) : lev;\n    });\n    // remove levels above or below range of values (i.e. unused colors), unless explicitly requested by client\n    if (propLevels.client.length === 0) {\n      if (levelLabels[levelLabels.length - 1] >= range[1]) {\n        levelLabels.pop();\n        cmap.pop();\n      }\n      if (levelLabels[0] < range[0]) {\n        levelLabels.shift();\n        cmap.shift();\n      }\n    }\n    updateLevels({\n      server: levelLabels\n    });\n    updateColors({\n      server: cmap\n    });\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [levels]);\n  useEffect(() => {\n    if (ref) {\n      const elemWidth = ref.current.offsetWidth;\n      const defaultWidth = cmap.length * 56;\n      setWidth(Math.min(defaultWidth, elemWidth));\n      setEachWidth(Math.min(defaultWidth, elemWidth) / cmap.length);\n    }\n  }, [cmap.length]);\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(TableContainer, {\n      className: classes.keyContainer,\n      ref: ref,\n      children: width && /*#__PURE__*/_jsxDEV(Table, {\n        size: \"small\",\n        padding: \"none\",\n        style: {\n          width: width\n        },\n        \"aria-label\": \"color table\",\n        children: /*#__PURE__*/_jsxDEV(TableBody, {\n          children: /*#__PURE__*/_jsxDEV(TableRow, {\n            children: color_styles.map((cs, i) => /*#__PURE__*/_jsxDEV(TableCell, {\n              style: cs\n            }, i, false, {\n              fileName: _jsxFileName,\n              lineNumber: 62,\n              columnNumber: 10\n            }, this))\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 60,\n            columnNumber: 8\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 59,\n          columnNumber: 7\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 58,\n        columnNumber: 6\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 56,\n      columnNumber: 4\n    }, this), /*#__PURE__*/_jsxDEV(TableContainer, {\n      children: width && /*#__PURE__*/_jsxDEV(Table, {\n        size: \"small\",\n        padding: \"none\",\n        style: {\n          width: width\n        },\n        \"aria-label\": \"color table\",\n        children: /*#__PURE__*/_jsxDEV(TableBody, {\n          children: /*#__PURE__*/_jsxDEV(TableRow, {\n            children: [/*#__PURE__*/_jsxDEV(TableCell, {\n              style: {\n                width: eachWidth / 2\n              }\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 75,\n              columnNumber: 9\n            }, this), propLevels.server.map((lv, i) => /*#__PURE__*/_jsxDEV(TableCell, {\n              align: \"center\",\n              style: {\n                width: eachWidth\n              },\n              children: lv\n            }, i, false, {\n              fileName: _jsxFileName,\n              lineNumber: 77,\n              columnNumber: 10\n            }, this)), /*#__PURE__*/_jsxDEV(TableCell, {\n              style: {\n                width: eachWidth / 2\n              }\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 79,\n              columnNumber: 9\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 74,\n            columnNumber: 8\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 73,\n          columnNumber: 7\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 72,\n        columnNumber: 6\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 70,\n      columnNumber: 4\n    }, this)]\n  }, void 0, true);\n};\n_s(MapLegend, \"TWDlLI2Kv2Ycq+QEgYbBLlFow7Q=\", false, function () {\n  return [useStyles];\n});\n_c = MapLegend;\nexport default MapLegend;\nvar _c;\n$RefreshReg$(_c, \"MapLegend\");","map":{"version":3,"names":["React","useEffect","useRef","useState","Table","TableBody","TableCell","TableContainer","TableRow","makeStyles","jsxDEV","_jsxDEV","Fragment","_Fragment","useStyles","theme","keyContainer","marginTop","MapLegend","props","_s","imgInfo","propLevels","updateLevels","updateColors","levels","cmap","range","width","setWidth","eachWidth","setEachWidth","ref","classes","color_styles","map","color","height","backgroundColor","opacity","levelLabels","lev","Math","abs","round","parseFloat","toFixed","client","length","pop","shift","server","elemWidth","current","offsetWidth","defaultWidth","min","children","className","size","padding","style","cs","i","fileName","_jsxFileName","lineNumber","columnNumber","lv","align","_c","$RefreshReg$"],"sources":["/Users/keith/progs/React/ncei-normals-mapper/src/components/MapLegend.js"],"sourcesContent":["import React, { useEffect, useRef, useState } from \"react\";\nimport Table from '@mui/material/Table';\nimport TableBody from '@mui/material/TableBody';\nimport TableCell from '@mui/material/TableCell';\nimport TableContainer from '@mui/material/TableContainer';\nimport TableRow from '@mui/material/TableRow';\nimport { makeStyles } from '@mui/styles';\n\nconst useStyles = makeStyles((theme) => ({\n\tkeyContainer: {\n\t\tmarginTop: \"1em\",\n\t},\n}));\n\nconst MapLegend = (props) => {\n\tconst { imgInfo, propLevels, updateLevels, updateColors } = props;\n\tconst { levels, cmap, range } = imgInfo;\n\tconst [ width, setWidth ] = useState();\n\tconst [ eachWidth, setEachWidth ] = useState();\n\tconst ref = useRef(null);\n\tconst classes = useStyles();\n\tconst color_styles = cmap.map((color) => { return {height: \"28px\", backgroundColor: color, opacity: \"0.8\"} });\n\n\tuseEffect(() => {\n\t\t// trim off insignificant digits e.g. 1.10000000001 => 1.1\n\t\tconst levelLabels = levels.map((lev) => {\n\t\t\treturn (Math.abs(Math.round(lev*100)/100 - lev) > 0) ? parseFloat(lev.toFixed(2)) : lev;\n\t\t})\n\t\t// remove levels above or below range of values (i.e. unused colors), unless explicitly requested by client\n\t\tif (propLevels.client.length === 0) {\n\t\t\tif (levelLabels[levelLabels.length-1] >= range[1]) {\n\t\t\t\tlevelLabels.pop();\n\t\t\t\tcmap.pop();\n\t\t\t}\n\t\t\tif (levelLabels[0] < range[0]) {\n\t\t\t\tlevelLabels.shift()\n\t\t\t\tcmap.shift()\n\t\t\t}\n\t\t}\n\t\tupdateLevels({server: levelLabels});\n\t\tupdateColors({server: cmap});\n\t\t// eslint-disable-next-line react-hooks/exhaustive-deps\n\t}, [levels])\n\n\tuseEffect(() => {\n\t\tif (ref) {\n\t\t\tconst elemWidth = ref.current.offsetWidth;\n\t\t\tconst defaultWidth = cmap.length * 56;\n\t\t\tsetWidth(Math.min(defaultWidth, elemWidth));\n\t\t\tsetEachWidth(Math.min(defaultWidth, elemWidth)/cmap.length);\n\t\t}\n\t},[cmap.length]);\n\n\treturn (\n\t\t<>\n\t\t\t<TableContainer className={classes.keyContainer} ref={ref}>\n\t\t\t\t{width &&\n\t\t\t\t\t<Table size=\"small\" padding=\"none\" style={{width:width}} aria-label=\"color table\">\n\t\t\t\t\t\t<TableBody>\n\t\t\t\t\t\t\t<TableRow>\n\t\t\t\t\t\t\t\t{color_styles.map((cs, i) => (\n\t\t\t\t\t\t\t\t\t<TableCell key={i} style={cs}></TableCell>\n\t\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t\t</TableRow>\t\n\t\t\t\t\t\t</TableBody>\n\t\t\t\t\t</Table>\n\t\t\t\t}\n\t\t\t</TableContainer>\n\n\t\t\t<TableContainer>\n\t\t\t\t{width &&\n\t\t\t\t\t<Table size=\"small\" padding=\"none\" style={{width:width}} aria-label=\"color table\">\n\t\t\t\t\t\t<TableBody>\n\t\t\t\t\t\t\t<TableRow>\n\t\t\t\t\t\t\t\t<TableCell style={{width:eachWidth/2}}></TableCell>\n\t\t\t\t\t\t\t\t{propLevels.server.map((lv, i) => (\n\t\t\t\t\t\t\t\t\t<TableCell key={i}align=\"center\" style={{width:eachWidth}}>{lv}</TableCell>\n\t\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t\t\t<TableCell style={{width:eachWidth/2}}></TableCell>\n\t\t\t\t\t\t\t</TableRow>\t\n\t\t\t\t\t\t</TableBody>\n\t\t\t\t\t</Table>\n\t\t\t\t}\n\t\t\t</TableContainer>\n\t\t</>\n\t);\n}\n\nexport default MapLegend;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}