{"ast":null,"code":"import _slicedToArray from\"/Users/keith/progs/React/ncei-normals-mapper/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useEffect,useRef,useState,useContext}from\"react\";import Table from'@mui/material/Table';import TableBody from'@mui/material/TableBody';import TableCell from'@mui/material/TableCell';import TableContainer from'@mui/material/TableContainer';import TableRow from'@mui/material/TableRow';import InputParamsContext from'./InputParamsContext';import{makeStyles}from'@mui/styles';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var useStyles=makeStyles(function(theme){return{keyContainer:{marginTop:\"1em\"}};});var MapLegend=function MapLegend(props){var imgInfo=props.imgInfo;var levels=imgInfo.levels,cmap=imgInfo.cmap,range=imgInfo.range;var _useState=useState(),_useState2=_slicedToArray(_useState,2),width=_useState2[0],setWidth=_useState2[1];var _useState3=useState(),_useState4=_slicedToArray(_useState3,2),eachWidth=_useState4[0],setEachWidth=_useState4[1];var ref=useRef(null);var classes=useStyles();var color_styles=cmap.map(function(color){return{height:\"28px\",backgroundColor:color,opacity:\"0.8\"};});var inputContext=useContext(InputParamsContext);useEffect(function(){// trim off insignificant digits e.g. 1.10000000001 => 1.1\nvar levelLabels=levels.map(function(lev){return Math.abs(Math.round(lev*100)/100-lev)>0?parseFloat(lev.toFixed(2)):lev;});// remove levels above or below range of values (i.e. unused colors), unless explicitly requested by client\nif(inputContext.levels.client.length===0){if(levelLabels[levelLabels.length-1]>=range[1]){levelLabels.pop();cmap.pop();}if(levelLabels[0]<range[0]){levelLabels.shift();cmap.shift();}}inputContext.updateLevels({server:levelLabels});inputContext.updateColors({server:cmap});// eslint-disable-next-line\n},[levels]);useEffect(function(){if(ref){var elemWidth=ref.current.offsetWidth;var defaultWidth=cmap.length*56;setWidth(Math.min(defaultWidth,elemWidth));setEachWidth(Math.min(defaultWidth,elemWidth)/cmap.length);}},[cmap.length]);return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(TableContainer,{className:classes.keyContainer,ref:ref,children:width&&/*#__PURE__*/_jsx(Table,{size:\"small\",padding:\"none\",style:{width:width},\"aria-label\":\"color table\",children:/*#__PURE__*/_jsx(TableBody,{children:/*#__PURE__*/_jsx(TableRow,{children:color_styles.map(function(cs,i){return/*#__PURE__*/_jsx(TableCell,{style:cs},i);})})})})}),/*#__PURE__*/_jsx(TableContainer,{children:width&&/*#__PURE__*/_jsx(Table,{size:\"small\",padding:\"none\",style:{width:width},\"aria-label\":\"color table\",children:/*#__PURE__*/_jsx(TableBody,{children:/*#__PURE__*/_jsxs(TableRow,{children:[/*#__PURE__*/_jsx(TableCell,{style:{width:eachWidth/2}}),inputContext.levels.server.map(function(lv,i){return/*#__PURE__*/_jsx(TableCell,{align:\"center\",style:{width:eachWidth},children:lv},i);}),/*#__PURE__*/_jsx(TableCell,{style:{width:eachWidth/2}})]})})})})]});};export default MapLegend;","map":{"version":3,"names":["React","useEffect","useRef","useState","useContext","Table","TableBody","TableCell","TableContainer","TableRow","InputParamsContext","makeStyles","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","useStyles","theme","keyContainer","marginTop","MapLegend","props","imgInfo","levels","cmap","range","_useState","_useState2","_slicedToArray","width","setWidth","_useState3","_useState4","eachWidth","setEachWidth","ref","classes","color_styles","map","color","height","backgroundColor","opacity","inputContext","levelLabels","lev","Math","abs","round","parseFloat","toFixed","client","length","pop","shift","updateLevels","server","updateColors","elemWidth","current","offsetWidth","defaultWidth","min","children","className","size","padding","style","cs","i","lv","align"],"sources":["/Users/keith/progs/React/ncei-normals-mapper/src/components/MapLegend.js"],"sourcesContent":["import React, { useEffect, useRef, useState, useContext } from \"react\";\nimport Table from '@mui/material/Table';\nimport TableBody from '@mui/material/TableBody';\nimport TableCell from '@mui/material/TableCell';\nimport TableContainer from '@mui/material/TableContainer';\nimport TableRow from '@mui/material/TableRow';\nimport InputParamsContext from './InputParamsContext';\nimport { makeStyles } from '@mui/styles';\n\nconst useStyles = makeStyles((theme) => ({\n\tkeyContainer: {\n\t\tmarginTop: \"1em\",\n\t},\n}));\n\nconst MapLegend = (props) => {\n\tconst { imgInfo } = props;\n\tconst { levels, cmap, range } = imgInfo;\n\tconst [ width, setWidth ] = useState();\n\tconst [ eachWidth, setEachWidth ] = useState();\n\tconst ref = useRef(null);\n\tconst classes = useStyles();\n\tconst color_styles = cmap.map((color) => { return {height: \"28px\", backgroundColor: color, opacity: \"0.8\"} });\n\tconst inputContext = useContext(InputParamsContext);\n\n\tuseEffect(() => {\n\t\t// trim off insignificant digits e.g. 1.10000000001 => 1.1\n\t\tconst levelLabels = levels.map((lev) => {\n\t\t\treturn (Math.abs(Math.round(lev*100)/100 - lev) > 0) ? parseFloat(lev.toFixed(2)) : lev;\n\t\t})\n\t\t// remove levels above or below range of values (i.e. unused colors), unless explicitly requested by client\n\t\tif (inputContext.levels.client.length === 0) {\n\t\t\tif (levelLabels[levelLabels.length-1] >= range[1]) {\n\t\t\t\tlevelLabels.pop();\n\t\t\t\tcmap.pop();\n\t\t\t}\n\t\t\tif (levelLabels[0] < range[0]) {\n\t\t\t\tlevelLabels.shift()\n\t\t\t\tcmap.shift()\n\t\t\t}\n\t\t}\n\t\tinputContext.updateLevels({server: levelLabels});\n\t\tinputContext.updateColors({server: cmap});\n\t\t// eslint-disable-next-line\n\t}, [levels])\n\n\tuseEffect(() => {\n\t\tif (ref) {\n\t\t\tconst elemWidth = ref.current.offsetWidth;\n\t\t\tconst defaultWidth = cmap.length * 56;\n\t\t\tsetWidth(Math.min(defaultWidth, elemWidth));\n\t\t\tsetEachWidth(Math.min(defaultWidth, elemWidth)/cmap.length);\n\t\t}\n\t},[cmap.length]);\n\n\treturn (\n\t\t<>\n\t\t\t<TableContainer className={classes.keyContainer} ref={ref}>\n\t\t\t\t{width &&\n\t\t\t\t\t<Table size=\"small\" padding=\"none\" style={{width:width}} aria-label=\"color table\">\n\t\t\t\t\t\t<TableBody>\n\t\t\t\t\t\t\t<TableRow>\n\t\t\t\t\t\t\t\t{color_styles.map((cs, i) => (\n\t\t\t\t\t\t\t\t\t<TableCell key={i} style={cs}></TableCell>\n\t\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t\t</TableRow>\t\n\t\t\t\t\t\t</TableBody>\n\t\t\t\t\t</Table>\n\t\t\t\t}\n\t\t\t</TableContainer>\n\n\t\t\t<TableContainer>\n\t\t\t\t{width &&\n\t\t\t\t\t<Table size=\"small\" padding=\"none\" style={{width:width}} aria-label=\"color table\">\n\t\t\t\t\t\t<TableBody>\n\t\t\t\t\t\t\t<TableRow>\n\t\t\t\t\t\t\t\t<TableCell style={{width:eachWidth/2}}></TableCell>\n\t\t\t\t\t\t\t\t{inputContext.levels.server.map((lv, i) => (\n\t\t\t\t\t\t\t\t\t<TableCell key={i}align=\"center\" style={{width:eachWidth}}>{lv}</TableCell>\n\t\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t\t\t<TableCell style={{width:eachWidth/2}}></TableCell>\n\t\t\t\t\t\t\t</TableRow>\t\n\t\t\t\t\t\t</TableBody>\n\t\t\t\t\t</Table>\n\t\t\t\t}\n\t\t\t</TableContainer>\n\t\t</>\n\t);\n}\n\nexport default MapLegend;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}