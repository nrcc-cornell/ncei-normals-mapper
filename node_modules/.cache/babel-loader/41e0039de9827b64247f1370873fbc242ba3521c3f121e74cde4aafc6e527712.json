{"ast":null,"code":"var _jsxFileName = \"/Users/keith/progs/React/ncei-normals-mapper/src/components/MapLegend.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useRef, useState } from \"react\";\nimport Table from '@mui/material/Table';\nimport TableBody from '@mui/material/TableBody';\nimport TableCell from '@mui/material/TableCell';\nimport TableContainer from '@mui/material/TableContainer';\nimport TableRow from '@mui/material/TableRow';\nimport { makeStyles } from '@mui/styles';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst useStyles = makeStyles(theme => ({\n  keyContainer: {\n    marginTop: \"1em\"\n  }\n}));\nconst MapLegend = props => {\n  _s();\n  const {\n    imgInfo,\n    levels,\n    updateLevels,\n    updateColors\n  } = props;\n  const {\n    localLevels,\n    cmap,\n    range\n  } = imgInfo;\n  const [width, setWidth] = useState();\n  const [eachWidth, setEachWidth] = useState();\n  const ref = useRef(null);\n  const classes = useStyles();\n  const color_styles = cmap.map(color => {\n    return {\n      height: \"28px\",\n      backgroundColor: color,\n      opacity: \"0.8\"\n    };\n  });\n  console.log(levels);\n  useEffect(() => {\n    // trim off insignificant digits e.g. 1.10000000001 => 1.1\n    const levelLabels = levels.map(lev => {\n      return Math.abs(Math.round(lev * 100) / 100 - lev) > 0 ? parseFloat(lev.toFixed(2)) : lev;\n    });\n    // remove levels above or below range of values (i.e. unused colors), unless explicitly requested by client\n    if (localLevels.client.length === 0) {\n      if (levelLabels[levelLabels.length - 1] >= range[1]) {\n        levelLabels.pop();\n        cmap.pop();\n      }\n      if (levelLabels[0] < range[0]) {\n        levelLabels.shift();\n        cmap.shift();\n      }\n    }\n    updateLevels({\n      server: levelLabels\n    });\n    updateColors({\n      server: cmap\n    });\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [localLevels]);\n  useEffect(() => {\n    if (ref) {\n      const elemWidth = ref.current.offsetWidth;\n      const defaultWidth = cmap.length * 56;\n      setWidth(Math.min(defaultWidth, elemWidth));\n      setEachWidth(Math.min(defaultWidth, elemWidth) / cmap.length);\n    }\n  }, [cmap.length]);\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(TableContainer, {\n      className: classes.keyContainer,\n      ref: ref,\n      children: width && /*#__PURE__*/_jsxDEV(Table, {\n        size: \"small\",\n        padding: \"none\",\n        style: {\n          width: width\n        },\n        \"aria-label\": \"color table\",\n        children: /*#__PURE__*/_jsxDEV(TableBody, {\n          children: /*#__PURE__*/_jsxDEV(TableRow, {\n            children: color_styles.map((cs, i) => /*#__PURE__*/_jsxDEV(TableCell, {\n              style: cs\n            }, i, false, {\n              fileName: _jsxFileName,\n              lineNumber: 62,\n              columnNumber: 10\n            }, this))\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 60,\n            columnNumber: 8\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 59,\n          columnNumber: 7\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 58,\n        columnNumber: 6\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 56,\n      columnNumber: 4\n    }, this), /*#__PURE__*/_jsxDEV(TableContainer, {\n      children: width && /*#__PURE__*/_jsxDEV(Table, {\n        size: \"small\",\n        padding: \"none\",\n        style: {\n          width: width\n        },\n        \"aria-label\": \"color table\",\n        children: /*#__PURE__*/_jsxDEV(TableBody, {\n          children: /*#__PURE__*/_jsxDEV(TableRow, {\n            children: [/*#__PURE__*/_jsxDEV(TableCell, {\n              style: {\n                width: eachWidth / 2\n              }\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 75,\n              columnNumber: 9\n            }, this), levels.server.map((lv, i) => /*#__PURE__*/_jsxDEV(TableCell, {\n              align: \"center\",\n              style: {\n                width: eachWidth\n              },\n              children: lv\n            }, i, false, {\n              fileName: _jsxFileName,\n              lineNumber: 77,\n              columnNumber: 10\n            }, this)), /*#__PURE__*/_jsxDEV(TableCell, {\n              style: {\n                width: eachWidth / 2\n              }\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 79,\n              columnNumber: 9\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 74,\n            columnNumber: 8\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 73,\n          columnNumber: 7\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 72,\n        columnNumber: 6\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 70,\n      columnNumber: 4\n    }, this)]\n  }, void 0, true);\n};\n_s(MapLegend, \"TWDlLI2Kv2Ycq+QEgYbBLlFow7Q=\", false, function () {\n  return [useStyles];\n});\n_c = MapLegend;\nexport default MapLegend;\nvar _c;\n$RefreshReg$(_c, \"MapLegend\");","map":{"version":3,"names":["React","useEffect","useRef","useState","Table","TableBody","TableCell","TableContainer","TableRow","makeStyles","jsxDEV","_jsxDEV","Fragment","_Fragment","useStyles","theme","keyContainer","marginTop","MapLegend","props","_s","imgInfo","levels","updateLevels","updateColors","localLevels","cmap","range","width","setWidth","eachWidth","setEachWidth","ref","classes","color_styles","map","color","height","backgroundColor","opacity","console","log","levelLabels","lev","Math","abs","round","parseFloat","toFixed","client","length","pop","shift","server","elemWidth","current","offsetWidth","defaultWidth","min","children","className","size","padding","style","cs","i","fileName","_jsxFileName","lineNumber","columnNumber","lv","align","_c","$RefreshReg$"],"sources":["/Users/keith/progs/React/ncei-normals-mapper/src/components/MapLegend.js"],"sourcesContent":["import React, { useEffect, useRef, useState } from \"react\";\nimport Table from '@mui/material/Table';\nimport TableBody from '@mui/material/TableBody';\nimport TableCell from '@mui/material/TableCell';\nimport TableContainer from '@mui/material/TableContainer';\nimport TableRow from '@mui/material/TableRow';\nimport { makeStyles } from '@mui/styles';\n\nconst useStyles = makeStyles((theme) => ({\n\tkeyContainer: {\n\t\tmarginTop: \"1em\",\n\t},\n}));\n\nconst MapLegend = (props) => {\n\tconst { imgInfo, levels, updateLevels, updateColors } = props;\n\tconst { localLevels, cmap, range } = imgInfo;\n\tconst [ width, setWidth ] = useState();\n\tconst [ eachWidth, setEachWidth ] = useState();\n\tconst ref = useRef(null);\n\tconst classes = useStyles();\n\tconst color_styles = cmap.map((color) => { return {height: \"28px\", backgroundColor: color, opacity: \"0.8\"} });\nconsole.log(levels)\n\tuseEffect(() => {\n\t\t// trim off insignificant digits e.g. 1.10000000001 => 1.1\n\t\tconst levelLabels = levels.map((lev) => {\n\t\t\treturn (Math.abs(Math.round(lev*100)/100 - lev) > 0) ? parseFloat(lev.toFixed(2)) : lev;\n\t\t})\n\t\t// remove levels above or below range of values (i.e. unused colors), unless explicitly requested by client\n\t\tif (localLevels.client.length === 0) {\n\t\t\tif (levelLabels[levelLabels.length-1] >= range[1]) {\n\t\t\t\tlevelLabels.pop();\n\t\t\t\tcmap.pop();\n\t\t\t}\n\t\t\tif (levelLabels[0] < range[0]) {\n\t\t\t\tlevelLabels.shift()\n\t\t\t\tcmap.shift()\n\t\t\t}\n\t\t}\n\t\tupdateLevels({server: levelLabels});\n\t\tupdateColors({server: cmap});\n\t\t// eslint-disable-next-line react-hooks/exhaustive-deps\n\t}, [localLevels])\n\n\tuseEffect(() => {\n\t\tif (ref) {\n\t\t\tconst elemWidth = ref.current.offsetWidth;\n\t\t\tconst defaultWidth = cmap.length * 56;\n\t\t\tsetWidth(Math.min(defaultWidth, elemWidth));\n\t\t\tsetEachWidth(Math.min(defaultWidth, elemWidth)/cmap.length);\n\t\t}\n\t},[cmap.length]);\n\n\treturn (\n\t\t<>\n\t\t\t<TableContainer className={classes.keyContainer} ref={ref}>\n\t\t\t\t{width &&\n\t\t\t\t\t<Table size=\"small\" padding=\"none\" style={{width:width}} aria-label=\"color table\">\n\t\t\t\t\t\t<TableBody>\n\t\t\t\t\t\t\t<TableRow>\n\t\t\t\t\t\t\t\t{color_styles.map((cs, i) => (\n\t\t\t\t\t\t\t\t\t<TableCell key={i} style={cs}></TableCell>\n\t\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t\t</TableRow>\t\n\t\t\t\t\t\t</TableBody>\n\t\t\t\t\t</Table>\n\t\t\t\t}\n\t\t\t</TableContainer>\n\n\t\t\t<TableContainer>\n\t\t\t\t{width &&\n\t\t\t\t\t<Table size=\"small\" padding=\"none\" style={{width:width}} aria-label=\"color table\">\n\t\t\t\t\t\t<TableBody>\n\t\t\t\t\t\t\t<TableRow>\n\t\t\t\t\t\t\t\t<TableCell style={{width:eachWidth/2}}></TableCell>\n\t\t\t\t\t\t\t\t{levels.server.map((lv, i) => (\n\t\t\t\t\t\t\t\t\t<TableCell key={i}align=\"center\" style={{width:eachWidth}}>{lv}</TableCell>\n\t\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t\t\t<TableCell style={{width:eachWidth/2}}></TableCell>\n\t\t\t\t\t\t\t</TableRow>\t\n\t\t\t\t\t\t</TableBody>\n\t\t\t\t\t</Table>\n\t\t\t\t}\n\t\t\t</TableContainer>\n\t\t</>\n\t);\n}\n\nexport default MapLegend;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}