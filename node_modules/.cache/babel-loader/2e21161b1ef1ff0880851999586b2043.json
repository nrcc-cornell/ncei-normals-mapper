{"ast":null,"code":"import _slicedToArray from\"/Users/kle1/progs/React/ncei-normals-mapper/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import React,{useEffect,useRef,useState,useContext}from\"react\";import Table from'@material-ui/core/Table';import TableBody from'@material-ui/core/TableBody';import TableCell from'@material-ui/core/TableCell';import TableContainer from'@material-ui/core/TableContainer';import TableRow from'@material-ui/core/TableRow';import InputParamsContext from'./InputParamsContext';import{makeStyles}from'@material-ui/core/styles';var useStyles=makeStyles(function(theme){return{keyContainer:{marginTop:\"1em\"}};});var MapLegend=function MapLegend(props){var imgInfo=props.imgInfo;var levels=imgInfo.levels,cmap=imgInfo.cmap,range=imgInfo.range;var _useState=useState(),_useState2=_slicedToArray(_useState,2),width=_useState2[0],setWidth=_useState2[1];var _useState3=useState(),_useState4=_slicedToArray(_useState3,2),eachWidth=_useState4[0],setEachWidth=_useState4[1];var ref=useRef(null);var classes=useStyles();var color_styles=cmap.map(function(color){return{height:\"28px\",backgroundColor:color,opacity:\"0.8\"};});var inputContext=useContext(InputParamsContext);useEffect(function(){// trim off insignificant digits e.g. 1.10000000001 => 1.1\nvar levelLabels=levels.map(function(lev){return Math.abs(Math.round(lev*100)/100-lev)>0?parseFloat(lev.toFixed(2)):lev;});// remove levels above or below range of values (i.e. unused colors), unless explicitly requested by client\nif(inputContext.levels.client.length===0){if(levelLabels[levelLabels.length-1]>=range[1]){levelLabels.pop();cmap.pop();}if(levelLabels[0]<range[0]){levelLabels.shift();cmap.shift();}}inputContext.updateLevels({server:levelLabels});inputContext.updateColors({server:cmap});// eslint-disable-next-line react-hooks/exhaustive-deps\n},[levels]);useEffect(function(){if(ref){var elemWidth=ref.current.offsetWidth;var defaultWidth=cmap.length*56;setWidth(Math.min(defaultWidth,elemWidth));setEachWidth(Math.min(defaultWidth,elemWidth)/cmap.length);}},[cmap.length]);return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(TableContainer,{className:classes.keyContainer,ref:ref,children:width&&/*#__PURE__*/_jsx(Table,{size:\"small\",padding:\"none\",style:{width:width},\"aria-label\":\"color table\",children:/*#__PURE__*/_jsx(TableBody,{children:/*#__PURE__*/_jsx(TableRow,{children:color_styles.map(function(cs,i){return/*#__PURE__*/_jsx(TableCell,{style:cs},i);})})})})}),/*#__PURE__*/_jsx(TableContainer,{children:width&&/*#__PURE__*/_jsx(Table,{size:\"small\",padding:\"none\",style:{width:width},\"aria-label\":\"color table\",children:/*#__PURE__*/_jsx(TableBody,{children:/*#__PURE__*/_jsxs(TableRow,{children:[/*#__PURE__*/_jsx(TableCell,{style:{width:eachWidth/2}}),inputContext.levels.server.map(function(lv,i){return/*#__PURE__*/_jsx(TableCell,{align:\"center\",style:{width:eachWidth},children:lv},i);}),/*#__PURE__*/_jsx(TableCell,{style:{width:eachWidth/2}})]})})})})]});};export default MapLegend;","map":{"version":3,"sources":["/Users/kle1/progs/React/ncei-normals-mapper/src/components/MapLegend.js"],"names":["React","useEffect","useRef","useState","useContext","Table","TableBody","TableCell","TableContainer","TableRow","InputParamsContext","makeStyles","useStyles","theme","keyContainer","marginTop","MapLegend","props","imgInfo","levels","cmap","range","width","setWidth","eachWidth","setEachWidth","ref","classes","color_styles","map","color","height","backgroundColor","opacity","inputContext","levelLabels","lev","Math","abs","round","parseFloat","toFixed","client","length","pop","shift","updateLevels","server","updateColors","elemWidth","current","offsetWidth","defaultWidth","min","cs","i","lv"],"mappings":"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","sourcesContent":["import React, { useEffect, useRef, useState, useContext } from \"react\";\nimport Table from '@material-ui/core/Table';\nimport TableBody from '@material-ui/core/TableBody';\nimport TableCell from '@material-ui/core/TableCell';\nimport TableContainer from '@material-ui/core/TableContainer';\nimport TableRow from '@material-ui/core/TableRow';\nimport InputParamsContext from './InputParamsContext';\nimport { makeStyles } from '@material-ui/core/styles';\n\nconst useStyles = makeStyles((theme) => ({\n\tkeyContainer: {\n\t\tmarginTop: \"1em\",\n\t},\n}));\n\nconst MapLegend = (props) => {\n\tconst { imgInfo } = props;\n\tconst { levels, cmap, range } = imgInfo;\n\tconst [ width, setWidth ] = useState();\n\tconst [ eachWidth, setEachWidth ] = useState();\n\tconst ref = useRef(null);\n\tconst classes = useStyles();\n\tconst color_styles = cmap.map((color) => { return {height: \"28px\", backgroundColor: color, opacity: \"0.8\"} });\n\tconst inputContext = useContext(InputParamsContext);\n\n\tuseEffect(() => {\n\t\t// trim off insignificant digits e.g. 1.10000000001 => 1.1\n\t\tconst levelLabels = levels.map((lev) => {\n\t\t\treturn (Math.abs(Math.round(lev*100)/100 - lev) > 0) ? parseFloat(lev.toFixed(2)) : lev;\n\t\t})\n\t\t// remove levels above or below range of values (i.e. unused colors), unless explicitly requested by client\n\t\tif (inputContext.levels.client.length === 0) {\n\t\t\tif (levelLabels[levelLabels.length-1] >= range[1]) {\n\t\t\t\tlevelLabels.pop();\n\t\t\t\tcmap.pop();\n\t\t\t}\n\t\t\tif (levelLabels[0] < range[0]) {\n\t\t\t\tlevelLabels.shift()\n\t\t\t\tcmap.shift()\n\t\t\t}\n\t\t}\n\t\tinputContext.updateLevels({server: levelLabels});\n\t\tinputContext.updateColors({server: cmap});\n\t\t// eslint-disable-next-line react-hooks/exhaustive-deps\n\t}, [levels])\n\n\tuseEffect(() => {\n\t\tif (ref) {\n\t\t\tconst elemWidth = ref.current.offsetWidth;\n\t\t\tconst defaultWidth = cmap.length * 56;\n\t\t\tsetWidth(Math.min(defaultWidth, elemWidth));\n\t\t\tsetEachWidth(Math.min(defaultWidth, elemWidth)/cmap.length);\n\t\t}\n\t},[cmap.length]);\n\n\treturn (\n\t\t<>\n\t\t\t<TableContainer className={classes.keyContainer} ref={ref}>\n\t\t\t\t{width &&\n\t\t\t\t\t<Table size=\"small\" padding=\"none\" style={{width:width}} aria-label=\"color table\">\n\t\t\t\t\t\t<TableBody>\n\t\t\t\t\t\t\t<TableRow>\n\t\t\t\t\t\t\t\t{color_styles.map((cs, i) => (\n\t\t\t\t\t\t\t\t\t<TableCell key={i} style={cs}></TableCell>\n\t\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t\t</TableRow>\t\n\t\t\t\t\t\t</TableBody>\n\t\t\t\t\t</Table>\n\t\t\t\t}\n\t\t\t</TableContainer>\n\n\t\t\t<TableContainer>\n\t\t\t\t{width &&\n\t\t\t\t\t<Table size=\"small\" padding=\"none\" style={{width:width}} aria-label=\"color table\">\n\t\t\t\t\t\t<TableBody>\n\t\t\t\t\t\t\t<TableRow>\n\t\t\t\t\t\t\t\t<TableCell style={{width:eachWidth/2}}></TableCell>\n\t\t\t\t\t\t\t\t{inputContext.levels.server.map((lv, i) => (\n\t\t\t\t\t\t\t\t\t<TableCell key={i}align=\"center\" style={{width:eachWidth}}>{lv}</TableCell>\n\t\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t\t\t<TableCell style={{width:eachWidth/2}}></TableCell>\n\t\t\t\t\t\t\t</TableRow>\t\n\t\t\t\t\t\t</TableBody>\n\t\t\t\t\t</Table>\n\t\t\t\t}\n\t\t\t</TableContainer>\n\t\t</>\n\t);\n}\n\nexport default MapLegend;\n"]},"metadata":{},"sourceType":"module"}