{"ast":null,"code":"import _slicedToArray from\"/Users/kle1/progs/React/normals-viewer/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import React,{useEffect,useState}from\"react\";import CircularProgress from\"@material-ui/core/CircularProgress\";import DisplayMap from\"./DisplayMap\";var GetImage=function GetImage(){var _useState=useState(),_useState2=_slicedToArray(_useState,2),mapBlob=_useState2[0],setMapBlob=_useState2[1];var _useState3=useState(),_useState4=_slicedToArray(_useState3,2),mapError=_useState4[0],setMapError=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),loading=_useState6[0],setLoading=_useState6[1];var fetchMap=function fetchMap(){var input_params={\"grid\":\"nrcc-nn\",\"state\":\"ME,WV\",\"sdate\":\"2020-01\",\"edate\":\"2020-01\",\"elems\":[{\"name\":\"pcpn\",\"interval\":[0,1],\"duration\":1,\"reduce\":\"sum\"}],\"output\":\"gif\"};// Reset \nsetMapBlob();setMapError();setLoading(true);fetch(\"https://grid2.rcc-acis.org/GridData\",{body:JSON.stringify(input_params),method:\"POST\"}).then(function(response){if(!response.ok){setMapError(\"Error fetching the map\");return;}return response.blob();}).then(function(responseBlob){setMapBlob(URL.createObjectURL(responseBlob));}).catch(function(err){setMapError(err.message);}).finally(function(){setLoading(false);});};useEffect(function(){fetchMap();},[]);return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsxs(\"div\",{children:[loading&&/*#__PURE__*/_jsx(CircularProgress,{}),mapBlob&&/*#__PURE__*/_jsx(DisplayMap,{imgsrc:mapBlob}),mapError&&/*#__PURE__*/_jsxs(\"p\",{children:[\"Error: \",mapError]})]})});};export default GetImage;","map":{"version":3,"sources":["/Users/kle1/progs/React/normals-viewer/src/components/GetImage.js"],"names":["React","useEffect","useState","CircularProgress","DisplayMap","GetImage","mapBlob","setMapBlob","mapError","setMapError","loading","setLoading","fetchMap","input_params","fetch","body","JSON","stringify","method","then","response","ok","blob","responseBlob","URL","createObjectURL","catch","err","message","finally"],"mappings":"0SAAA,MAAOA,CAAAA,KAAP,EAAeC,SAAf,CAA0BC,QAA1B,KAAyC,OAAzC,CACA,MAAOC,CAAAA,gBAAP,KAA6B,oCAA7B,CACA,MAAOC,CAAAA,UAAP,KAAuB,cAAvB,CAEA,GAAMC,CAAAA,QAAQ,CAAG,QAAXA,CAAAA,QAAW,EAAM,eAEQH,QAAQ,EAFhB,wCAEfI,OAFe,eAENC,UAFM,8BAGUL,QAAQ,EAHlB,yCAGfM,QAHe,eAGLC,WAHK,8BAIQP,QAAQ,CAAC,KAAD,CAJhB,yCAIfQ,OAJe,eAINC,UAJM,eAMtB,GAAMC,CAAAA,QAAQ,CAAG,QAAXA,CAAAA,QAAW,EAAM,CACtB,GAAMC,CAAAA,YAAY,CAAG,CACpB,OAAO,SADa,CAEpB,QAAQ,OAFY,CAGpB,QAAQ,SAHY,CAIpB,QAAQ,SAJY,CAKpB,QAAQ,CAAC,CACR,OAAO,MADC,CAER,WAAW,CAAC,CAAD,CAAG,CAAH,CAFH,CAGR,WAAW,CAHH,CAIR,SAAS,KAJD,CAAD,CALY,CAWpB,SAAS,KAXW,CAArB,CAcA;AACAN,UAAU,GACVE,WAAW,GACXE,UAAU,CAAC,IAAD,CAAV,CAEAG,KAAK,CAAC,qCAAD,CAAwC,CAACC,IAAI,CAAEC,IAAI,CAACC,SAAL,CAAeJ,YAAf,CAAP,CAAqCK,MAAM,CAAE,MAA7C,CAAxC,CAAL,CACEC,IADF,CACO,SAAAC,QAAQ,CAAI,CACjB,GAAI,CAACA,QAAQ,CAACC,EAAd,CAAkB,CACjBZ,WAAW,CAAC,wBAAD,CAAX,CACA,OACA,CACD,MAAOW,CAAAA,QAAQ,CAACE,IAAT,EAAP,CACA,CAPF,EAQEH,IARF,CAQO,SAAAI,YAAY,CAAI,CACpBhB,UAAU,CAACiB,GAAG,CAACC,eAAJ,CAAoBF,YAApB,CAAD,CAAV,CACA,CAVH,EAWEG,KAXF,CAWQ,SAAAC,GAAG,CAAI,CACblB,WAAW,CAACkB,GAAG,CAACC,OAAL,CAAX,CACA,CAbF,EAcEC,OAdF,CAcU,UAAM,CACdlB,UAAU,CAAC,KAAD,CAAV,CACA,CAhBF,EAiBA,CArCD,CAuCAV,SAAS,CAAC,UAAM,CACbW,QAAQ,GACT,CAFO,CAEL,EAFK,CAAT,CAIA,mBACC,sCACC,uBACEF,OAAO,eACP,KAAC,gBAAD,IAFF,CAIEJ,OAAO,eACP,KAAC,UAAD,EACC,MAAM,CAAEA,OADT,EALF,CASEE,QAAQ,eACR,+BAAWA,QAAX,GAVF,GADD,EADD,CAiBA,CAlED,CAoEA,cAAeH,CAAAA,QAAf","sourcesContent":["import React, {useEffect, useState} from \"react\";\nimport CircularProgress from \"@material-ui/core/CircularProgress\";\nimport DisplayMap from \"./DisplayMap\";\n\nconst GetImage = () => {\n\n\tconst [mapBlob, setMapBlob] = useState();\n\tconst [mapError, setMapError] = useState();\n\tconst [loading, setLoading] = useState(false);\n\n\tconst fetchMap = () => {\n\t\tconst input_params = {\n\t\t\t\"grid\":\"nrcc-nn\",\n\t\t\t\"state\":\"ME,WV\",\n\t\t\t\"sdate\":\"2020-01\",\n\t\t\t\"edate\":\"2020-01\",\n\t\t\t\"elems\":[{\n\t\t\t\t\"name\":\"pcpn\",\n\t\t\t\t\"interval\":[0,1],\n\t\t\t\t\"duration\":1,\n\t\t\t\t\"reduce\":\"sum\"\n\t\t\t}],\n\t\t\t\"output\":\"gif\"\n\t\t};\n\n\t\t// Reset \n\t\tsetMapBlob();\n\t\tsetMapError();\n\t\tsetLoading(true);\n\n\t\tfetch(\"https://grid2.rcc-acis.org/GridData\", {body: JSON.stringify(input_params), method: \"POST\"})\n\t\t\t.then(response => {\n\t\t\t\tif (!response.ok) {\n\t\t\t\t\tsetMapError(\"Error fetching the map\");\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\treturn response.blob()\n\t\t\t})\n\t\t\t.then(responseBlob => {\n\t\t\t\t\tsetMapBlob(URL.createObjectURL(responseBlob));\n\t\t\t\t})\n\t\t\t.catch(err => {\n\t\t\t\tsetMapError(err.message);\n\t\t\t})\n\t\t\t.finally(() => {\n\t\t\t\tsetLoading(false);\n\t\t\t});\n\t}\n\n\tuseEffect(() => {\n    fetchMap();\n  }, []);\n\n\treturn (\n\t\t<>\n\t\t\t<div>\n\t\t\t\t{loading &&\n\t\t\t\t\t<CircularProgress />\n\t\t\t\t}\n\t\t\t\t{mapBlob &&\n\t\t\t\t\t<DisplayMap \n\t\t\t\t\t\timgsrc={mapBlob}\n\t\t\t\t\t/>\n\t\t\t\t}\n\t\t\t\t{mapError &&\n\t\t\t\t\t<p>Error: {mapError}</p>\n\t\t\t\t}\n\t\t\t</div>\n\t\t</>\n\t);\n}\n\nexport default GetImage;"]},"metadata":{},"sourceType":"module"}