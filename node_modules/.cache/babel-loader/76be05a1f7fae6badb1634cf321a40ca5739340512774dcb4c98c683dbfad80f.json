{"ast":null,"code":"import _slicedToArray from\"/Users/keith/progs/React/ncei-normals-mapper/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useEffect,useRef,useState}from\"react\";import Table from'@mui/material/Table';import TableBody from'@mui/material/TableBody';import TableCell from'@mui/material/TableCell';import TableContainer from'@mui/material/TableContainer';import TableRow from'@mui/material/TableRow';import{makeStyles}from'@mui/styles';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var useStyles=makeStyles(function(theme){return{keyContainer:{marginTop:\"1em\"}};});var MapLegend=function MapLegend(props){var imgInfo=props.imgInfo,propLevels=props.propLevels,updateLevels=props.updateLevels,updateColors=props.updateColors;var levels=imgInfo.levels,cmap=imgInfo.cmap,range=imgInfo.range;var _useState=useState(),_useState2=_slicedToArray(_useState,2),width=_useState2[0],setWidth=_useState2[1];var _useState3=useState(),_useState4=_slicedToArray(_useState3,2),eachWidth=_useState4[0],setEachWidth=_useState4[1];var ref=useRef(null);var classes=useStyles();var color_styles=cmap.map(function(color){return{height:\"28px\",backgroundColor:color,opacity:\"0.8\"};});useEffect(function(){// trim off insignificant digits e.g. 1.10000000001 => 1.1\nvar levelLabels=levels.map(function(lev){return Math.abs(Math.round(lev*100)/100-lev)>0?parseFloat(lev.toFixed(2)):lev;});// remove levels above or below range of values (i.e. unused colors), unless explicitly requested by client\nif(propLevels.client.length===0){if(levelLabels[levelLabels.length-1]>=range[1]){levelLabels.pop();cmap.pop();}if(levelLabels[0]<range[0]){levelLabels.shift();cmap.shift();}}updateLevels({server:levelLabels});updateColors({server:cmap});// eslint-disable-next-line react-hooks/exhaustive-deps\n},[levels]);useEffect(function(){if(ref){var elemWidth=ref.current.offsetWidth;var defaultWidth=cmap.length*56;setWidth(Math.min(defaultWidth,elemWidth));setEachWidth(Math.min(defaultWidth,elemWidth)/cmap.length);}},[cmap.length]);return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(TableContainer,{className:classes.keyContainer,ref:ref,children:width&&/*#__PURE__*/_jsx(Table,{size:\"small\",padding:\"none\",style:{width:width},\"aria-label\":\"color table\",children:/*#__PURE__*/_jsx(TableBody,{children:/*#__PURE__*/_jsx(TableRow,{children:color_styles.map(function(cs,i){return/*#__PURE__*/_jsx(TableCell,{style:cs},i);})})})})}),/*#__PURE__*/_jsx(TableContainer,{children:width&&/*#__PURE__*/_jsx(Table,{size:\"small\",padding:\"none\",style:{width:width},\"aria-label\":\"color table\",children:/*#__PURE__*/_jsx(TableBody,{children:/*#__PURE__*/_jsxs(TableRow,{children:[/*#__PURE__*/_jsx(TableCell,{style:{width:eachWidth/2}}),propLevels.server.map(function(lv,i){return/*#__PURE__*/_jsx(TableCell,{align:\"center\",style:{width:eachWidth},children:lv},i);}),/*#__PURE__*/_jsx(TableCell,{style:{width:eachWidth/2}})]})})})})]});};export default MapLegend;","map":{"version":3,"names":["React","useEffect","useRef","useState","Table","TableBody","TableCell","TableContainer","TableRow","makeStyles","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","useStyles","theme","keyContainer","marginTop","MapLegend","props","imgInfo","propLevels","updateLevels","updateColors","levels","cmap","range","_useState","_useState2","_slicedToArray","width","setWidth","_useState3","_useState4","eachWidth","setEachWidth","ref","classes","color_styles","map","color","height","backgroundColor","opacity","levelLabels","lev","Math","abs","round","parseFloat","toFixed","client","length","pop","shift","server","elemWidth","current","offsetWidth","defaultWidth","min","children","className","size","padding","style","cs","i","lv","align"],"sources":["/Users/keith/progs/React/ncei-normals-mapper/src/components/MapLegend.js"],"sourcesContent":["import React, { useEffect, useRef, useState } from \"react\";\nimport Table from '@mui/material/Table';\nimport TableBody from '@mui/material/TableBody';\nimport TableCell from '@mui/material/TableCell';\nimport TableContainer from '@mui/material/TableContainer';\nimport TableRow from '@mui/material/TableRow';\nimport { makeStyles } from '@mui/styles';\n\nconst useStyles = makeStyles((theme) => ({\n\tkeyContainer: {\n\t\tmarginTop: \"1em\",\n\t},\n}));\n\nconst MapLegend = (props) => {\n\tconst { imgInfo, propLevels, updateLevels, updateColors } = props;\n\tconst { levels, cmap, range } = imgInfo;\n\tconst [ width, setWidth ] = useState();\n\tconst [ eachWidth, setEachWidth ] = useState();\n\tconst ref = useRef(null);\n\tconst classes = useStyles();\n\tconst color_styles = cmap.map((color) => { return {height: \"28px\", backgroundColor: color, opacity: \"0.8\"} });\n\n\tuseEffect(() => {\n\t\t// trim off insignificant digits e.g. 1.10000000001 => 1.1\n\t\tconst levelLabels = levels.map((lev) => {\n\t\t\treturn (Math.abs(Math.round(lev*100)/100 - lev) > 0) ? parseFloat(lev.toFixed(2)) : lev;\n\t\t})\n\t\t// remove levels above or below range of values (i.e. unused colors), unless explicitly requested by client\n\t\tif (propLevels.client.length === 0) {\n\t\t\tif (levelLabels[levelLabels.length-1] >= range[1]) {\n\t\t\t\tlevelLabels.pop();\n\t\t\t\tcmap.pop();\n\t\t\t}\n\t\t\tif (levelLabels[0] < range[0]) {\n\t\t\t\tlevelLabels.shift()\n\t\t\t\tcmap.shift()\n\t\t\t}\n\t\t}\n\t\tupdateLevels({server: levelLabels});\n\t\tupdateColors({server: cmap});\n\t\t// eslint-disable-next-line react-hooks/exhaustive-deps\n\t}, [levels])\n\n\tuseEffect(() => {\n\t\tif (ref) {\n\t\t\tconst elemWidth = ref.current.offsetWidth;\n\t\t\tconst defaultWidth = cmap.length * 56;\n\t\t\tsetWidth(Math.min(defaultWidth, elemWidth));\n\t\t\tsetEachWidth(Math.min(defaultWidth, elemWidth)/cmap.length);\n\t\t}\n\t},[cmap.length]);\n\n\treturn (\n\t\t<>\n\t\t\t<TableContainer className={classes.keyContainer} ref={ref}>\n\t\t\t\t{width &&\n\t\t\t\t\t<Table size=\"small\" padding=\"none\" style={{width:width}} aria-label=\"color table\">\n\t\t\t\t\t\t<TableBody>\n\t\t\t\t\t\t\t<TableRow>\n\t\t\t\t\t\t\t\t{color_styles.map((cs, i) => (\n\t\t\t\t\t\t\t\t\t<TableCell key={i} style={cs}></TableCell>\n\t\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t\t</TableRow>\t\n\t\t\t\t\t\t</TableBody>\n\t\t\t\t\t</Table>\n\t\t\t\t}\n\t\t\t</TableContainer>\n\n\t\t\t<TableContainer>\n\t\t\t\t{width &&\n\t\t\t\t\t<Table size=\"small\" padding=\"none\" style={{width:width}} aria-label=\"color table\">\n\t\t\t\t\t\t<TableBody>\n\t\t\t\t\t\t\t<TableRow>\n\t\t\t\t\t\t\t\t<TableCell style={{width:eachWidth/2}}></TableCell>\n\t\t\t\t\t\t\t\t{propLevels.server.map((lv, i) => (\n\t\t\t\t\t\t\t\t\t<TableCell key={i}align=\"center\" style={{width:eachWidth}}>{lv}</TableCell>\n\t\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t\t\t<TableCell style={{width:eachWidth/2}}></TableCell>\n\t\t\t\t\t\t\t</TableRow>\t\n\t\t\t\t\t\t</TableBody>\n\t\t\t\t\t</Table>\n\t\t\t\t}\n\t\t\t</TableContainer>\n\t\t</>\n\t);\n}\n\nexport default MapLegend;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}